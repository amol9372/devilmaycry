<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/jquery/dist/jquery.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/powerbi-client/dist/powerbi.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/powerbi-client/dist/powerbi.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.3/es6-shim.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>Power Bi - Report</title>
    <style>
        div {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            margin-top: 100px
        }
    </style>
    <script type="text/javascript">
        window.onload = function () {
        
            var models = window['powerbi-client'].models;

            var permissions = models.Permissions.All;

            var embedConfiguration = {
                type: 'report',
                //pageName: 'ReportSection',
                // visualName: '5a874c7e3621b4bb98b9',
                accessToken: 'H4sIAAAAAAAEACWWtw7syBFF_-WlFEDvBGxA771nRs-h90NS0L9rtJtXd3D73Dr9nz929gxzVv7595-cbMfKcbzr3fcbD-37vXFOJ8j0AI88oJ_xwh1ArzefTF6NIYqGCl3uMyBdlzEPv-8Y5QgnrI22F8WA7n4Aft0W43aunDG7d-DnMwNNYOTNE--yQaCDIuH6qny3sGW5qMIzlIaHLmYhznCrqrjAafxMvCVunAfjta-dGwJyMxJlIFRSSu0-7wR38ddDMgvfR-aAo5NQ8zuaWjVPt9iiBBXQGrhGaVMOLh1waPM1vWG9sKYenjmpJ3CdHYFtR30khi8yYjGIgQZ2ySqbfh9Xik7rlK2UBDae4TMBWLZq4kNkwHZtUiVbOHZYFmcumZE1WR3NRoMy6TG2AS1SzVUbfgWuonBj0LoJGXD58hmt6pxWG_SgfZ7fkZUFoClesANtB9peb8G84d7kX7cEdv2WrujjFpLROkZUjtLLL2ajycVa4B5TbFzR5WerZKuJ0nSsW3dCUfItdTRzH0wovvsXwUzvizQNsUL2fNXuZTqEiy4pe4S5DU7-qEw652NYH0dgLJtf_M1iEFrfZJ3Zh8YpUfQ_V8Qn4hPYbbhc0TddJod3GosA3rBJNiwheCDqjqZOhcpA5Kvi7KiGNS4zWOzdHFdnUxiLrKMGjjzRtHpcQTvX5d6uYpj2SJnUrEKkGnUgj8CiKfzZWCnMIR5q2m8oX5NEToNw2CgPSo6MoYxL7TEk1QW2u74ZqsV4OmLFsCWEwk6WrWsjScw6kCmmp8EoN2zFvS7aKU7gw_y3YnRDPHTw9dXQJnrIPpcFjp_u4ODdTFOZrIXXTe6tsuFFOAx2i_2dzo_pqNYk77DMRwkP5AMExEKRj8_ow03G5V4is4xQdDtwAFvegfV9oDKjfxnljCUyyhBvDbtOOjwsvAEYBI1W0gqBrQxSfwCxNig56c90yUlJ_karzs0ywUIjpNIzNm_mi8brxw3JvDQh85OFuJxVbLjRrwfHkwRJuR7nH3yzi7kVfNYSVTA7n_d4V4r5YldVlMMnRxWha6dXWCgZRFoisBiAIGf26vuLU4i196eQltdCR81tZcT35kvjljXbZvQ1_o4qax3LXn0VhGXWB66ykNQd_Q4hGMPX7JVw0Crgkb_wxk9fCsg0k5v8DDwj1tizh_vArY9biTBzT7ywky15eM_x87f_pUIzuA50oC5dicyO4ibwCz4YPR8cKUgnLwdhEnQAGgYtxG6k_vwr2RJvT2YCQgR0ifpRYcHh2wqS5nMmJmbup6VBJB1HeZbtQKcZmZ6GZ6G0mdifseiH0KFLtaZKEyJTLKBwaQ_c8_Ku2HJcTA8EFlxEW4uFUtSOJ1MKdLHyuw3WIZ9DeisPS1AnSVKUqjYm_p4-v-I2lQvd66iCBmD55g80L0zYaIi06zMeRUlMe5YS8fO67GG_t-VUdzx7fQGJChX2UvrRyg7CTyBEgE2PaqcECphiYRzQlRHcDGTaGlQHUXS8Dcq_aA95ouEKm0KQQUYJlhPZel1WnE1vUcJ0rkXeeQxHNoOvZTKuBqZ0nFJ4pvrwiJfGXaRXzCX5PI5z3Yf1bEqZTHoXwWuj9BWnoWdXyl-cmwvz1Shi_rTOqW6qs_lgVnshqn8CduDWimgu4p68MG93JDJ6_CtNRl-0RHZBkE-uqFCvc8FFZrUErux8IMl4pusdv3ww3Xt78gbwY6qkKZf5hRtYkdDZAlKJgySqgz7NOmyjApp6AKGECdEZIjLYzxHpx_slz6hOcyOncxuFBEdLQuPT9g7eZmMEbL2zVBHgH5eVeW9KQTPMaw71xo31TMCFcu9dvzKNAtdtI7WaLBX6HqjocnBdWu54kzjf3FON4DId3oP-xFyy4m2Oi2GnB3l7RrPzaUn8NAgRSS1Fe0AU8uJyB4V6qJ_Xtq_LcdkfZsS6F9kidEKLWpSLlqGx91DJvzuY4IrpwtCv_nZzi3qTieGhser9FWFYVOEw5eMHQU8WmkNO3sxcF3430QJcfo3ZOZQWHyNxPgSYkyf_bjLbR1iVKqVEIkreDuhqyS1HifROw_AWrmO52JNJ7gB81qCb0Gpw7h_UlgoobMR9XsHiV5EFxRfSjQ3GJSY7B0fHyE9ShBpoHFXjgFrM0cR-mQ6nwqO-ICB8bawgDXcPRNxMN6grQrmsKU41DND8p0aDTw24hdoCZXYEV4zPDv0C6RYl2UrFqtJ4u3X-O7OABXxn-UUkitH84YNkPdn_GIjHVCknkqEaKhV6tztPc_bPOdeyW4OVviHV9UNvY6IgNkiFkbx32tfclyJy0JiMvqvWieFopVOUKE2Q_qyRCJ5kb6r729_FrF4OEN9v6GxfVvRyk__K7GovTP5jZv4a-PU5wjC51OdnF4xaw4L5668___rDbc9yzFr1_L5JFwFz5t6WZQfHhztDkY1U8WufXZeLVvsiC6h1cwbxGijL4HMhyOBce-wmoDRkeQVn0k0DVrhKNEMQQbtrsRcWaxKAXN9bmsfL63Dq6AZD5FCFDI-ro8pEo6TJIn8T7xNHdUnJGWuG18S2nruqUjroR1wMKYflV44cKT-HDP5ZGr44_Qru0UB_h9n_WizKouEF3BDbmwu7S4ySkPZt_uzQgEB-RfF3HvD3Zm0qHDOGGNB34BRsisqSfKdzSZ_NaJusz5q3Fj_HVsK2Ifklk8s_S0Wjsg4ixPO-Q1HmvArneYSIPCCFffce92DIJXm3AxVQs5Os3JEv3SBjAY061xxvozb_xPwsbbUp4S9l0j6YMbdLt1Xfj6s7a-JDgfP3lPdppuw4t-o3tvgDug2j5SkMyQr7G1Z3JAcnS32xzXA7Y-spBW3OQyYrc33QVczBFLQsI5WVFDKdc1OSeva8ekWLI6Q2Ns68ikq5hWpqfNK2Y1syOi6D4fA6hGPUexNRvIYPnYW6w7i2dRulfQmtRwHIYfErLfB_GuKsCAzno_TmKx95weiP74rJEgskYunb37SpXqt0VgZy9vr7UgZ0LDRPGlhgfYn2V427WcMhN8GMOz1pt-r6hchGfR9b0o4Kz7Oy2DkxPcfJ9E-OwCi1FTSqQkdrXI7Oucd12-Hf897gStjsRsSRMNlIbFM02NZ9S4Mf_EZzfEZ4y5QahzUL9oUrp0j1CWYiLsT-z_x__wdzdhxIGgwAAA==',
                id: '1887fbcb-2caa-4f40-b9b1-6ddc4e466186',
                //for Power BI Embedded
                tokenType: models.TokenType.Embed,
                //tokenType: tokenType == '0' ? models.TokenType.Aad : models.TokenType.Embed,
                embedUrl: 'https://app.powerbi.com/reportEmbed?reportId=1887fbcb-2caa-4f40-b9b1-6ddc4e466186&groupId=cb6d2214-38ec-405c-a7fc-92d3c32602f9',
                permissions: permissions,
                settings: {
                    filterPaneEnabled: true,
                    navContentPaneEnabled: true
                }

            };

            var $reportContainer = $('#reportContainer');
            var report = powerbi.embed($reportContainer.get(0), embedConfiguration);

        }

        function showVisuals() {
            var $reportContainer = $('#reportContainer')[0];
            var report = powerbi.get($reportContainer);

            report.getPages()
                .then(function (pages) {
                    // Retrieve active page.
                    var activePage = pages.find(function (page) {
                        console.log("Active page is : " + page.name + " - " + page.displayName);
                        return page.isActive;
                    });

                    activePage.getVisuals()
                        .then(function (visuals) {
                            console.log(
                                visuals.map(function (visual) {
                                    return {
                                        name: visual.name,
                                        type: visual.type,
                                        title: visual.title,
                                        layout: visual.layout
                                    };
                                }));
                        })
                        .catch(function (errors) {
                            console.log(errors);
                        });
                })
                .catch(function (errors) {
                    console.log(errors);
                });
        }       

        function showPage(pageName = "ReportSectione9dfbb33d4de29236d74") {
            var $reportContainer = $('#reportContainer')[0];
            var report = powerbi.get($reportContainer);
            const page = report.page('ReportSectione9dfbb33d4de29236d74');
            page.setActive();
            // report.setPage(pageName)
            //     .then(function () {
            //         console.log("Page was set to: " + pageName);
            //     })
            //     .catch(function (errors) {
            //         console.log(errors);
            //     });
        }
    </script>
</head>

<body>
    <div id="reportContainer"></div>
    <button id="showVisuals" onclick="showVisuals();">Show Visuals</button>
    <button id="showPage" onclick="showPage();">Show Page</button>
</body>

</html>