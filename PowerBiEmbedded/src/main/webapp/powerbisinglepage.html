<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/jquery/dist/jquery.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/powerbi-client/dist/powerbi.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/powerbi-client/dist/powerbi.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.3/es6-shim.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>Power Bi - Report</title>
    <style>
        div {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            margin-top: 100px
        }
    </style>
    <script type="text/javascript">
        window.onload = function () {
        
            var models = window['powerbi-client'].models;

            var permissions = models.Permissions.All;

            var embedConfiguration = {
                type: 'report',
                //pageName: 'ReportSection',
                // visualName: '5a874c7e3621b4bb98b9',
                accessToken: 'H4sIAAAAAAAEACVWtw7sCA77l9f6AOd0wBbjnHPunMc5x8X9-w12G1UEKBESxb__WOnTT2nx579_prNA5uiZFjS3zsQV2QUMbjyTyS7IrudxoKdgLZvsVExcBLMaCFSCvynDEy0fcM83B-QqowHbwUqPe3ECn6Guz6aphIPqq3wM9pm9bmqVgiGdBCTiBL4CMU_nJfRTtrqII09ZkAsa6SGZ-YCVoCpbBtRWegDvlmru1E5PzOCWFQgFxJ63TxiDDNy6rMTR-Sh8rfDr42gHukdJxfImXveNRGfsiV8cMCMTOMZtpOxWY6fRuIZd5mupqFQRF1yIAgOD2JLhau5oLh1Hx_ABzytgkhelPl12H4DzIBDP4b2kooPIX84Vr2Z-3G21tk0Bx-kU05CDTNm4cMsJGBJvh3Kwf4O-cbIaGWL8KAayyj5SaESdlcrOfDVChb4JyxTJV9yxS2o4X3-RHSHQ7M6yccOK9TNSUrGq0RvK8FQgFJCr3dztTCsk7mu7ok3ZE2-LcwFmbNbvdtrNDAwAkaaaQbKH4qgpFKi7SwNrFAn6n_pd0dzWnGZWbnoZ3XJwOe_-OChAjeU-rxPnazI4FTxQCOK3d7jJ3FI0jPDAgTFvy4vR77nwPEVADKaDoLzDA-05CykBG_xBLmWDESYXHzLeJdb6SZQ8iRz-yDSgxSjRYeVBYjVurV4quw74pPndjaF86OJhrEssVhStv9bes5AmXHOMviDio2ml2ru3zdAwvQquRCmdqFD5inIRsdkNo_dnIPaE_NrpWprIvT1CO2v6sKlzQPMh-nooZ28G81qoMFoSjYdE2FhwV2UXpZmMXWUPNcAWW4gPTw9IYaHzRLSmiZEJQAtocGSLSBec5hUjODPGcNaY12AZAT9MEQuHup_MEfjfazyTBSvIrmwlpDaWOMiqiTk-JaLIoUHmNfdqxiMhSSSX4bgWz0HtwHbibNDvSDLBFB9KpjA4PpkYxDvUct4EUm_ROPY5ZlOR9L0IdT-lk2UHWvUMOhE59YD4jRDMHM2cXjCN4_xbSRnUvAVlfZPyYmv4wNlzH24n4C-5q1apH8gHGCDIjNquCd2v7q7VkKABKayYgO8czH6VfE_zKi3RaySXhobycB5ppeTNDzkXNTRXOpJBmd6XybeJHVVYXaUpuoTJ7MY1lo2zXyrE2UEf16ALKaPLYMkSxM7MENrBMn82gN1noNxgBoS0RWQGKKZ6n32p7E17sUlDaKxBeDBG3XiTgaZtMoBuXnZfN1L_xmtc8fy-Ouz2nsZYIhySvP2r8yrd69dlI2TyUoQPu4BzDzVPrAsnsOCYmEY7OMyPBvO7oyY-lH2Jjm5BX_fFvlFtX8aRz-20UUXwsMuy73hnoXXmK1ouXcHTiFw-LOHcKrVaOwKIbi9kfcAFCNBRqcgIu4fyyDPDqstH6jk-QvrpQKPXTX4ERaKjnMBUU14_75Jk71SezEBwasSM82L2FKu4wEubQWlPd4nZU6EOnbkSTHeHF14lajNPpK5KZbPhHl9jkMbQbEin8idEGef01pi0hwOJ7G8KNOYPMJ8qq7v5iLTRsPf1FNiLnK3kp9nVrStvE6op-BaVao6wj1wX_lel7S_drkBJ8ejMV01vXql-UV6dp-5G0boNfeeUALIymYQJJc970XcJzhpKwI1Wad69vAW9T41IFUCrRUL2KtQaA-Ta9fiPjeKibDZEPze_EnafF_HSdTkGiDNCWvczi6lxkCJ9vs6gHbXDGHr33j0TWvHMj0o0oJ_Nuoj3p7CCxMiEOjShEftbfY1JQ1suzXzsq8LkiMKuSm5aLylSO1GU6W-ggPbmx1WYcWgtYB9AtvzjQHT9G6Wvfo8qj4QYWPYJ2P2u-7Yi3NWIMow5KieCwyE5vAJSJTnk87aEkZxCdE89w82Zvd6b3PzWGa-fb2dQNKQhveCfjppsium0FBb0S2EuH7gNbAUlOBa10PVnIwA2wRaGWE6S7IPxYG0Klz-bFqwNt9ySMbGdFkwqTuTExWdChPTSsySOKbrMre-AvuWWvrsX7FmSAXRAq23aTeBcXlRsaaeibs8-3A_vEt5blpTclqdCxDuXtsZwCWjdOwO-GXJ6GhNtMqSBCz3v14iNZIcGMSeTBh79-rAYvEdcAsnTcd8XPzK89N_k4IvJEAkqm55QwhcOmEeHEYTZ1eRPO0QnXsklEqwLKGFRmYMCRR53MHzwGBWd6600DMEfv37MMUBe0NqEE22xuYIdKi3OSTwHNCqt3fSmiMA-BK7KVb02Gxohq1p7Pdq-eqQkm7c9x96JzDwsA4mUBr4ge8N9-jZcEcV_sN6GIQs9-w8kKM7TEQnj9J_swuGaG6nQj4WynaFRz__6858_7PrM-6SWzy_6wHKVZyIgQ5mD3LqS4d139SvlkPLMiaOrgDODvZlKZPLwR1MvgenWyDfZMW33gfcrLF-O5lPeGMn05dvxIIuVwRG2vjXhVsvzKLjzGE6HezcKWIIjasFWPwNrC72GGibUJDF7BFAH9MkzpH3r2RhdshxTHYBW6b0lh-dYf2M3cK7ekuKnWLSbO3HISJ3i56ZrloC_HJLpZaYja7FpJ-ix0ds4HI-cfmTMtB-xNICUINFwvet8JsfOLMIIawek-FRz6aMpFxC1ZagpzJaWeIaHhc3zkKECZ8JACRHBDIs8u7gDeDDfHWKqzY795URim_SiV4gRsghYuVoe8eQhpCEd9Rb7r39kfuZvucrBT-X6EiSuotl0do3sJFHvjQHoX5Tb1GO6H2v5g2m7elPjxFIa9lFqCN9CE71Fn190q0qmAAs6DsIfKlDoGixl0c8XynCeYUnaJkHE4umoHES_v5ehXJggSlhp9pqzujHoux2OMbfMkhBEYHXyIINEONAKvOxCpuXGNbrDuW0SpwYa-T3E0PNQsApVT_FIvylVkqsAKOFqyeFXsCxx51-_aZ5ulJNCzckAU9OY3Rop0YbRoZS8LQMu3tkJO8-7x-w5WWu4OX_Bq4UVmzXNajUGLIsi5v4ATX4HawHK7sahzdVAbx-iWX7Y10m0BskuEaKVj41GxqRjErDe4rNlkT-EPNmbQyE4dROYwORiSTOYSlsE0vWVN574Bj1PBjD31j-Z__d_4_Pu0e4LAAA=',
                id: '1887fbcb-2caa-4f40-b9b1-6ddc4e466186',
                //for Power BI Embedded
                tokenType: models.TokenType.Embed,
                //tokenType: tokenType == '0' ? models.TokenType.Aad : models.TokenType.Embed,
                embedUrl: 'https://app.powerbi.com/reportEmbed?reportId=1887fbcb-2caa-4f40-b9b1-6ddc4e466186&groupId=cb6d2214-38ec-405c-a7fc-92d3c32602f9',
                permissions: permissions,
                settings: {
                    filterPaneEnabled: true,
                    navContentPaneEnabled: true
                }

            };

            var $reportContainer = $('#reportContainer');
            var report = powerbi.embed($reportContainer.get(0), embedConfiguration);

        }

        function showVisuals() {
            var $reportContainer = $('#reportContainer')[0];
            var report = powerbi.get($reportContainer);

            report.getPages()
                .then(function (pages) {
                    // Retrieve active page.
                    var activePage = pages.find(function (page) {
                        console.log("Active page is : " + page.name + " - " + page.displayName);
                        return page.isActive;
                    });

                    activePage.getVisuals()
                        .then(function (visuals) {
                            console.log(
                                visuals.map(function (visual) {
                                    return {
                                        name: visual.name,
                                        type: visual.type,
                                        title: visual.title,
                                        layout: visual.layout
                                    };
                                }));
                        })
                        .catch(function (errors) {
                            console.log(errors);
                        });
                })
                .catch(function (errors) {
                    console.log(errors);
                });
        }       

        function showPage(pageName = "ReportSectione9dfbb33d4de29236d74") {
            var $reportContainer = $('#reportContainer')[0];
            var report = powerbi.get($reportContainer);
            const page = report.page('ReportSectione9dfbb33d4de29236d74');
            page.setActive();
            // report.setPage(pageName)
            //     .then(function () {
            //         console.log("Page was set to: " + pageName);
            //     })
            //     .catch(function (errors) {
            //         console.log(errors);
            //     });
        }
    </script>
</head>

<body>
    <div id="reportContainer"></div>
    <button id="showVisuals" onclick="showVisuals();">Show Visuals</button>
    <button id="showPage" onclick="showPage();">Show Page</button>
</body>

</html>