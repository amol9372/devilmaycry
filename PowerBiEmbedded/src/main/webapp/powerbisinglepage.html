<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/jquery/dist/jquery.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/powerbi-client/dist/powerbi.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/powerbi-client/dist/powerbi.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.3/es6-shim.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>Power Bi - Report</title>
    <style>
        div {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            margin-top: 100px
        }
    </style>
    <script type="text/javascript">
        window.onload = function () {
        
            var models = window['powerbi-client'].models;

            var permissions = models.Permissions.All;

            var embedConfiguration = {
                type: 'report',
                //pageName: 'ReportSection',
                // visualName: '5a874c7e3621b4bb98b9',
                accessToken: 'H4sIAAAAAAAEAB2WxQ70hg6F3-XfplKYKnURZpzwLsww4aS6735HXftYso7tz_73j50-w5wWf_7-gxQ8xzTYpvsHXKpJUALnhiB14S0Eu7EC97HZsdDfx-9BFhutGzBg2BrRGrpd4-45VSmEI6NNUMoqb-0cmxLNpN2Cbc8T38tYecbyi158Pa9r9rtPy036o147oI49ZsUnSynIh3caWujIc7QJEHCl250gXj7X3rdF5-Fr0jx-EGuT6y72rOQtFwLKqm3VnKk6SYRI4gzQcAkkSev1MUzFM2AHlOqtsx1mjRkgofRlWCrySeMxWuzQjn34W36SU-z8JRvplrma4CvHIMvPxH5-ep5oOfHEFc7lZN9OKazMvZPd5rxlvM_OGfl1KuL3w4ow1sIie1HjhN8ChqeXg3GoI49Kvyj-1AhkZ1tzyiP7nCnvwB5PVSxn8R3BW3RenjZdocMeNGUuTl3ccCT25vI6PyvqHhTksr3PPFqgAM6SYViEPQ702vymB_NamtKjxjGNjFQ85Uqw2bWLYSznT0l5rm158CWRtPVuHbO5teEiTdPCodbifMyT9QcLfSFiXdF7mAf5boEW7YmeyTcN0zR5vBO_PaaP1btee6IO2xEW0UwKRhc9v3qJ3bHLlHqKdGvxFchMFfKgPT3JVJ7e-Xl-NApDpthgp2nZrpTX1_WMO3xOyL4YrRKAvZkXqAcb09T8XrnzxmwvlxMuJ04jyDxg6Sx3LAu0z6KzX8ccSxqomD0p6TFe602Z2zEahVbn3po88i09N8BcxrnR7PpCfItv1VbGK4TKetgLZD0arOYUcT0pOqH4ps6vYfQRnNmdQAjLTOJFp2I61DP-bCe9fNyqim4UfANFyCtCRwph7m6K-u09hwDGOxBw8Ft4npDuAYKtjP0TibvdgXabk_eyzRVji0EvY9jg-eb2CDIaQ0-2ZZA3LapAWWccpEnmltWpwUXu2Lf6ZGUWXeeWf5H4LQlsbX7zZIBFQOXDQfELl7oYGKe6E2AGkTpiOtbrnCAs2TGn1gGVsnhAaGWc1Q25iE2udqqDCg9d4o5yr1u1BgwAIPAWp253JaMlRi6rNvnKbQUkZQMPyRmxthyADi00x2VjuJgsjijbIGrKsZLQJQUd21rfD27mR8O1V1uFw8EhH5faLLtgcIcmeU_3Y-hmNGs2hzl_NiazEj6EjeyiJAmzlhYsQpxVJTwdKEQCneDhcaItHoZaglkfbmKWhGOkypYYdI8BZdZxwDJIAsgWmLPVH8cUMMj6Slmpoqc-swSJvRD1tL8VGpDb4fo-G1bsXiaD8oHHytGoqJqXKulQwxuX1qMJiPClqjh3Jm8eogmZb1itu7d42ZFPlB9KNjaQQR4xZkJgwxuTPxGuULeipOeV1MINJY2r_TE52LYnfq-wEo0CXqLgzd0rI_Oa9TtbEk1ZIDoVDoYM_tEOY0B9nIh4xoaGGMfInWnnNixgGRoaYqTiEmEE6qYpKvK8ZaS2WNmtLpJEiF9q2CaHoCZEqnO_5pAbVbB3hRHR6K2y--xewU1hO3WKgbla1YM1HkrBlPY2v6E1rfbCquf9uCdjhWM-nT4czd4N2nPnHlqOXeepKWFSUU7-vs2qUIysPA5KjboU0X8Vl9BvBvZscoY7GUTlMvUY5XKt4OtpD3407ZBVzKYqfaMsPV1yJkG3mlsKRLm2cI8yk7oJCWKcckXJRLl5Q7jDrsCy9kaGoSQ0CeNQ2o_gfPkLG7QmmLNZjJQMkWXn7VlfV7PeWnRXLEyOJW7iEV1ae5ATFymHNK9-0WpNyFLFlPnacvBujigxyYUjEjmvv7o9d1h3La8YHCtTfW3gI5i5Vj6UJYfvUwOIKw70AV8MC7yeFyAo5jE-8QDuekSrHN95NNrmqUflNJ7rmWEzua-eAhHmD72KKKSDpjTOBtRu-UOd0nM9g0PgzEN9iot9isL8ipzuVRmycrWYkk6l-KBUlGHCO29fICyYgrmzUbXahKQPaq5-5wI80ZqdSjoBABCFTOFicEWTJxfFnwgHy6f1vZCcbcdyZKqbPrD4BPQXXFgJrlrsqCMigkniS_FG1JPDA7B5fVO3SpR8xGes47nwPSb2XXxll1lSUdrX9E0i0fRio4tz3I12j_V7vlxPXj4-kOzJ0qaYke9rxF42GCGyqGoCkYfd6hqoVfBDEbxuJYxI3zoW-pQfB8JXXdiEVnkzEUYC_YLbMcE_JDlnKHLmyZlCpqK-POtUIEzf1Zsj7bjBCaSdCeVoZ-ucvp0jEY6b6sC4AV0FwedxJJg60zsP1t62hFm6ka1GQPMrud-0y5ZKs1078TH21ix6qJWtPg71TQ5UjEFxvHVmP3xR7faOjCMHc_7589cfbn2Wff5Nw-_1EXLVFjjXHl46vSJJVIjHPL-JcAeoKA-12Q7SJi6Akl7H1leTkkv-h6ehQP-EUiY-w7i8S3z6DhW723oUfmlIiS62x5IQ8xDfnWXItxTG9qK3QKS4W4aC9-PE5v4rFupZV-lck6wuzwPMW3nQH65ljkWjcVidELO3QSlcwWCuEusTxnbJcJEI7VRYrZixJTKQMIAc88iy3w7wxrYFtOvVng85G3E5igyOg0BzvqKb5joDDP_rIa7b7XD0J26-geB17-pwzZZW1h0DVQJBdHL0XFDhj_bNyQq-23cscOpjSZDzYUzOIPtV4WooMS27ZDx0hbN-BivLUAlE95ccLdmxZ4P6n_9sfpamXJXg57Jh6sSZmBKT2myvRb5853p7_af6tPWU7sda_mThzp08u3zTkEPixzTS-YPcmaoWBDJR91vHz3G7-OF8tCQ7E20Yr_i1BXcVQtIksjqvK7pMdA0KqEJ75Niw7uytO9hugsvCTqHTvgrYGBjA3EFGMxx3ViVV7WTt2G-QH9MLjwYDCRsF8RRHcyPe4td31m86eAx34V0yD9xDDz4Xq5lwC3-GL58bmfjaq-FPkgHqmyWkLegrdBPBbz_kiprRw3VPbZSNyGDTLgmMRvWZVGqKNlaOOpEBvk6vIPctIhzfRiQPbOZ5pFlab1OsWjc598GzBdkQeZklVySDhnk4pFp-GOoqd4vbO9USN401xcUiAYuB5r24-NRAylbOojQHC8zP5v_9H2mlXY7uCwAA',
                id: '35fdaeec-503e-40c9-890b-b33fe449de56',
                //for Power BI Embedded
                tokenType: models.TokenType.Embed,
                //tokenType: tokenType == '0' ? models.TokenType.Aad : models.TokenType.Embed,
                embedUrl: 'https://app.powerbi.com/reportEmbed?reportId=35fdaeec-503e-40c9-890b-b33fe449de56&groupId=cb6d2214-38ec-405c-a7fc-92d3c32602f9',
                permissions: permissions,
                settings: {
                    filterPaneEnabled: true,
                    navContentPaneEnabled: true
                }

            };

            var $reportContainer = $('#reportContainer');
            var report = powerbi.embed($reportContainer.get(0), embedConfiguration);

        }

        function showVisuals() {
            var $reportContainer = $('#reportContainer')[0];
            var report = powerbi.get($reportContainer);

            report.getPages()
                .then(function (pages) {
                    // Retrieve active page.
                    var activePage = pages.find(function (page) {
                        console.log("Active page is : " + page.name + " - " + page.displayName);
                        return page.isActive;
                    });

                    activePage.getVisuals()
                        .then(function (visuals) {
                            console.log(
                                visuals.map(function (visual) {
                                    return {
                                        name: visual.name,
                                        type: visual.type,
                                        title: visual.title,
                                        layout: visual.layout
                                    };
                                }));
                        })
                        .catch(function (errors) {
                            console.log(errors);
                        });
                })
                .catch(function (errors) {
                    console.log(errors);
                });
        }       

        function showPage(pageName = "ReportSectione9dfbb33d4de29236d74") {
            var $reportContainer = $('#reportContainer')[0];
            var report = powerbi.get($reportContainer);
            const page = report.page('ReportSectione9dfbb33d4de29236d74');
            page.setActive();
            // report.setPage(pageName)
            //     .then(function () {
            //         console.log("Page was set to: " + pageName);
            //     })
            //     .catch(function (errors) {
            //         console.log(errors);
            //     });
        }
    </script>
</head>

<body>
    <div id="reportContainer"></div>
    <button id="showVisuals" onclick="showVisuals();">Show Visuals</button>
    <button id="showPage" onclick="showPage();">Show Page</button>
</body>

</html>