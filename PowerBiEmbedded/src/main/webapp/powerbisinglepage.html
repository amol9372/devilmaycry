<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/jquery/dist/jquery.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/powerbi-client/dist/powerbi.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/powerbi-client/dist/powerbi.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.3/es6-shim.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>Power Bi - Report</title>
    <style>
        div {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            margin-top: 100px
        }
    </style>
    <script type="text/javascript">
        window.onload = function () {


            var models = window['powerbi-client'].models;

            var permissions = models.Permissions.All;

            var embedConfiguration = {
                type: 'report',
                //pageName: 'Page 1',
               // visualName: '5a874c7e3621b4bb98b9',
                accessToken: 'H4sIAAAAAAAEACWWtQ70CBKE3-VPvZKZVtrAzMzOzDhjxtO9-81p8wq6v25V1X_-2NkzTln55-8_UUHW-F2r5Zqcr-r0GCAXeSJ2UPKyLtdQM1BBsPQ542E4FuWsHCULUaofrkJXFOpo9EZ199eXHOxiAUlX8Q6H_SomLKS25jMvjLwZMW2DRSVt7vYJt_L4uITiFjgzltGcJcl3IVhJpS2rLJlzX4Or1ezlDj8tYsovvGVFiwzAfBnCwiPEVwfraw2s4EGr8WgV_Zv7jS60oIMty4dhGSqfC-uxrYwQ7clxswXrusYGXCmf9_nx6dcE8gPsQg-Ny1RxnKg8D_oOmEt_JHcMwxbEC8SLCb4hvq7ZQBz93B8u9R2uYFQTgpwuie33iBsoYM5tvPxyo4ppZWXJm3K5XTdkMisLWxTYlvySiChfVlRrMuOg3ukCsG2hk9uXaEfjYJ1E6h4Rpd2weSdi5-laPvylNR1g4khlpZN1K6M7gEI5o4GRfbH23UtqAvr3mF2q-V4X62qT7NK4XyN9lRMPBZ4sd31XcQmDl9r2F2meyecQT3WjbzesmGSmmynqFZCbziPg0vbdMHaZXWV0moVaLRGWFNUxkBV1kYi_rOwQA45oRqBaTXEMuRcCcwA2IDmSDxG8t06InugkVtn1AVnU5MdNjqXRDQKLLcLMHcn5vrVweHIOYRHmGamB5Yg1RpdknwyUOfvGSsx7oesrHCqfDZnEESOolImJrmaZ4LMMLfDetkt7P4hQH0rR1M2s0qO-hKx00MSBzDa8sKsl7PJ6nvdl8eDRpByJV1fC6z1A4Fpo2yfwUSckFcVaEYtbVZfSk813BZF9cYiAOyYaUZrOhWePD0gSIW1aJrlbYoMyTNuFVkKY4eRKBHinE5pigydR2WaElM7IEMFcYw01q3XNgJcI7cvUpl709Hi99O6n3wxZrXJ9xFOtwFJdUE1Qt6-ih9HANV5bBvxRJSxNU1KMhn0z0kgPEhCxoPAoJh3YoJQ4eORa9DXMHmad6ChVhFGgTN8OZA3Zme5qDR7rQyts7fQfQhF5BHhU2Ac7izRBCgFDixujXh3WHehvQbpVDS2x3-rwF6kGl4ikTDM_56jweyZepKGtrF1k4iPq1BAj6osKGNszRRO_J5-J4sheFk6IhuhiO1PvN57YyJ2DOyq0mvX5lO-o1cfX6_FafWMUy5kQAVCYDTOUDT-BGosyeqozf1Lc9S7vwt5zfgaveACjk80DvstyiTjhh6j7xtTaPpUbVv8MxaaSk4K72USZ5kABzAdrAlJbiciPXJYBT2qLsAqpQIrPSIkODdAPQpP39ij1Woj9EFjCNJ3_yS_uwBm4jCEP7U5uztabWd4oNVBNFNlEkz1X9_ZdvY8kcahnBLzCKkJSb4cZtDHn242uaEMfJqnxIUnPL_plum3U8PSKk0DxpjDhnGnw3MZTmVCScsUYoZp5cVLYQKu1rKa21fzbq0YYvotBC5PFARhHF9jLwKAYXCr1PghmE3CI1P0APQMz_JxX_q3cp7qmsmDRGuP4ThO4DH0eRkp6ryK78BUJcy-sZkMIsH2FPV1W8Ihcxp2QqdJyvTg23CYm78zkbCltrP0DpZgl5p5ykaAUv6QPsPGnTB6LnkIGQfJL3gTbUQAj7ZFVkKiB1pm12_H3nhrsKz6j5quvTTh2uinkgw8yQUsiceff2cZMnxSKD-3sJw8dnBWKSGY4nP3dLjmTrYRQjrvwLXCTlavps5ClVq3Lz3BQxRZNw65q0IW6lUVcsyL0y1Fk8qcnnAD0r8pwVNzzLm5cHVegkXsO488Tm1H6oZZ6rntfxojyJnQ9I61aKCAlTZipyWb7g-IYAzQVuEm5_IuoGpNLNeznt3-I5NDlMxdntj2dNLI_bz8U3hnDxbe73uyY-CMWcsfAKTiAjHwNgvLrHOcNokk4AG-9ObnLFzqWzbBYMFcxmGia4et8qNe06o0zVMzdiRqmKsTB5FlrRfD6fA8unGT_MDZoLlKvQkgjkE6rho1G2ufoXFMrqYgMv0aO8Atj1nPprSSI1CKzyb717m1myrw8XbDVz1i1X6rWzI8kYRsapEzCnrgfb3R3ZXN8g_7GK1WsQ-DkuJw3Turv1Ukm24G2glB2wbT2kUm8mPk58NYUMpZQma7dhUdKS3WWqiopiXYAHC-vHP2QhrYGtsZfkzTF_eRYe0e5cUGIaSnvfY3QFaRHTAABhm-WWNbNAXqmJxmlrdb4ccNRCjYJgkdTlQnngkjc5CEvxEt1Ab4YiaFtzmAHGVTKFHC2pi2eYZL4G8ZZvsbF1Kdbbf46yMBPnQ3YQJ-SgFacxNBov4EMUQdt4KjtBjuGQaXvIrGpYNNRNfV2p1AXhDnPUrLTnp0N1o0s_in9PAF1D9wbNi7jc6cmAWP--efPX3-49Zn3SaueX02ycbeTYy21SXTeOPQQcUO5Kr70PaYBksNyeaevrqDGC2Vo43GIoRzVKAkw-fJsowM8QTRu6DZb4K9JAb8fN-16EPRgpuT9oihXotz35zDi41t3-CIrEzt0_jayq2kDdX8-zI5p4S9OK6MQNxmOsGHJTC6XgOqb8UHF8en1BtSi-k2mfDknGIkjAugmBSzmoMdoLIhU0BvbROqLe1YUlKdvF_Gdg2Daov8QNYCPRBwz9lwhO3CR28tXGuNyuRLmF3lzQJMvLsbECChCnw_lZCZn-dlLaFmt66FYMMknsuHgrJMYC0xJGc3rcvbtUYeB39l_yDSVQIXFcDZ699DqmA4yBpt_MT9zW61K-KN8ffCTVKAgmNn3JPx0Ea0J-Vfldc0324-1-smOpqG0VNTQlZGMwguEgxKgMQvgeaVvmPKJiFg8uv39NYG_INNxLEPSZfKKb09kroLzM8ggwjxVkfABxQjNx3Z2AbgOROBzCOZpuYv5c_W9RKGY6CLb1zpXpJ4mGlIes_RVPzyt79TgYAW9wOombMmYN3YpFNTLEzaEC5Iyo6hni_LMOTHNkAbOXi8gyskpe-lw4LZ0_EbC1MLdOrFKBTScOCnjSztlWm1hrvo-f5DmRg_S6210GU8K--FuMIrCTUUzPDB2QqM2uNL2X9vprrpjuO5sdbTNYCuNkY84GhesQO2Bj_M1UDTp-joZuOp6fOnNhnpoQ_MBYZZnTrNFv9qI9_6P-b__A1w6lgoaDAAA',
                id: '12b1b8d1-1703-4c8f-a2dc-118c12010652',
                //for Power BI Embedded
                tokenType: models.TokenType.Embed,
                //tokenType: tokenType == '0' ? models.TokenType.Aad : models.TokenType.Embed,
                embedUrl: 'https://app.powerbi.com/reportEmbed?reportId=12b1b8d1-1703-4c8f-a2dc-118c12010652&groupId=cb6d2214-38ec-405c-a7fc-92d3c32602f9',
                permissions: permissions,
                // settings: {
                //     filterPaneEnabled: true,
                //     navContentPaneEnabled: true
                // }
                settings: {
                    layoutType: models.LayoutType.Custom,
                    customLayout : {
                        pageSize: {
                            type: models.PageSizeType.Custom,
                            width: 1600,
                            height: 1200
                        },
                        displayOption: models.DisplayOption.ActualSize,
                        pagesLayout: {
                            "ReportSection": {
                                defaultLayout: {
                                    displayState: {
                                        mode: models.VisualContainerDisplayMode.Hidden
                                    }
                                },
                                visualsLayout: {
                                    "90de33ad17139b4104db": {
                                        x: 1,
                                        y: 1,
                                        z: 1,
                                        width: 400,
                                        height: 300,
                                        displayState: {
                                            mode: models.VisualContainerDisplayMode.Visible
                                        }
                                    }
                                }
                            }
                        }
                    }
                }

            };

            var $reportContainer = $('#reportContainer');

            var report = powerbi.embed($reportContainer.get(0), embedConfiguration);

        }

        function showVisuals() {
            var $reportContainer = $('#reportContainer')[0];
            var report = powerbi.get($reportContainer);

            report.getPages()
                .then(function (pages) {
                    // Retrieve active page.
                    var activePage = pages.find(function (page) {
                        console.log("Active page is : " + page.name + " - " + page.displayName);
                        return page.isActive
                    });

                    activePage.getVisuals()
                        .then(function (visuals) {
                            console.log(
                                visuals.map(function (visual) {
                                    return {
                                        name: visual.name,
                                        type: visual.type,
                                        title: visual.title,
                                        layout: visual.layout
                                    };
                                }));
                        })
                        .catch(function (errors) {
                            console.log(errors);
                        });
                })
                .catch(function (errors) {
                    console.log(errors);
                });
        }
    </script>
</head>

<body>
    <h1>Check your Report below</h1>
    <div id="reportContainer"></div>
    <button id="showVisuals" onclick="showVisuals();">Show Visuals</button>
</body>

</html>