<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/jquery/dist/jquery.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/powerbi-client/dist/powerbi.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/powerbi-client/dist/powerbi.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.3/es6-shim.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>Power Bi - Report</title>
    <style>
        div {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            margin-top: 100px
        }
    </style>
    <script type="text/javascript">
        window.onload = function () {
        
            var models = window['powerbi-client'].models;

            var permissions = models.Permissions.All;

            var embedConfiguration = {
                type: 'report',
                //pageName: 'ReportSection',
                // visualName: '5a874c7e3621b4bb98b9',
                accessToken: 'H4sIAAAAAAAEAB2WxQ70CA6E3-W_ZqQwjTSHMDPnlnSwwwyrffftnbslW_XZ5frPHzt7-ikr_vz9h6PSp1a0bQWUHhr5SP_QkBarr3zHijAaBEz7TLcUQII1y40s8sbC6pmDukYM0uKpWiH1txIg72njTRVhNGxOIqNCaB3zjQ-5YNF6BVTqko-3KUM89fNp9bDrdrpT0JpXElsNja649tbJVs4PWmX5LovIDoqD8djOItOiumlNEIBiC1VhVzVrcPoOSFJdNTDHsF912ipaKxgUzxFo0Sx0dKzn11IekFU0Yv7zmkkK7CGR3k-r6zbKJGpndpcfVq6C9YaoUBjX9DF3aAcyG655yEP_BdsKoylktsgVxyMh9keGFwJ6tJF3c23-w66f-0Hi0BORoQt3Fy2-prq1zFGnjKF05jqWu9ScE8Krl0W2xNXOS0jTYu0pvaaHcDUJ26ZYLhZvbAhvhA2XVB58WBh0vMPA8hTEjFn62qCB6Kqc5WQbfaykHN89dXUdyodXRjlSDVg7hSR8BcKAwX4TDcyeUpSh5qsFNyd1VHQEMCu6-SmGydQHjqKN6EtdYVp5EO1Vbw6FrzhTipM5ulf6nRKxP3sDIAh9AIFi5pVlTGHLYSBWUu99wak2e3A6qOWUXrFtREcmhOssn6SJgcwUFRYOsJtTBAfLr6e4mJNn5gIkYWkPRHy1KgCgxns1yF0edh_ZFflH2fuHFvN64RGgYwuR4J_ihDhU4xldl1CywYMEv8MIFifVmF5X-TYUj8U6Hhl7qEMPTwlEHmOcaYul5RwJUT34XvJJWysgHHFf47lHk6jDB7_BGIzJ6Sq_2KF8r1cPPDufLIAUiJq8fvvzwzMMwHJEBZO7Q19v9haIghkyAB0O9tYCX5VmAWroZsuQEVCv9Dnf2WoV4bKKKWwowQ0JEXfBO7p4KQ-2HXg3Tw4fY2_vvvNFysAOjNAnQgywGs7zgRVMHaSRBl6B2AK3mOfIdavf-FxnyF9eU-WvXlIWgc0tpSqnlkruxMj9OQUgTqJ8mOofVqkM5-JcSELV_aqLosvvUJAjAbPzgPhQPAGp7LZsw3FWz7c9fssq7CIYeNpcI5yQNsbWmRLFxoZLnLlmkGQG30_k_UDEBTPp6Wjt-S509zguMtjoSRpvoTuaDdm0o4hGkAn4ozWYje1-lu0AG28PfqRPk9ZxvSns-SDo2HJ5BHIs3DO3FDD0iJp2DS7YEkToyafw3633HF-WwNy37vqmSwzM-wfajdA1uGS52Jn1jBCH4K9YCc2X_ki-eX1D8EFIm1TW1baSB1OKCkkK2vLGLkjuCh7RuRCuBbDwQulqwcCeNroOtgXoWAFphN6pNJuS1UPFa5ejr-8OH4lldv1UtMEt85df2GdNWiU84yhmFG6GRRR8kSLhB76GUo2buzt9UsVRAWdqhg1kXUk2StL6EIeeFZPfdaZJxds5ua_xKflPniavaELbrBVbH0-OQ1pD3B8HOqepxiv7qmrp3nwGv1U5JHMK05RmaZPsJmmUfFa6zKbDlc2XCfLirR6CdppHmOYx_eR7wrtvG4RdrF1Z_OkzDXeKyWbt6wCmPM5akxnSTHgrIuctp0bg-hpJXf4wuP68nnAJpsuOnb26qz2N13XNeCC15q2AfdtzLbHhL_nTTMiQkpZNA1VtsbctDllZgkhR_GcqHolTlue_Ib5DHVDEZP0EznG_9ejz3yYuzaECOD4HsiV2lu4UaayVa8Kaaw2YfPbElVqp9U_mO1IaTzUK6mGAP8z3gAoPiALnoSK2vsB6AksUJD1HXW2-Fspod9J-4lgltcPPHnLm1mVLluZpVhwGJXufIId6yfoZlixfiFq8qf3QEoy0QXZJQe-B4jEj1hlk3ptmZOXrUaqpGk5jS88HezX8XNxFxbsDvDdv3KR5vzEZeG5uNcl4aUOuCShSoG618D0p-CvYDx2Ds1jIfTi0Cuy1CFqnrV6eXdUZXX_qES061LDX4m3Ta_2Ltg2XfzZnEFOz00C-IbQ3X6-CNn4fD_767ExSrHq_ZGEQB6psEN11N0WZEMuGDt3z7ZPnlKdp_c66j9EijJYmPoO_SzsgjeibT1PB-8BSiM4t7_50C4C79nm5HYM0U2zGCuWkmXydV3KT8ZZUOR5w7qd9RHPOm-CQm0-L9ghELkYQQ4QNKUUC-KK0XF5sy40_TR6WrHHSFWWPRxqFeaRGUMgpw5xCLeT2-InJDRBRGiQzEMjXwMrztofFp3tfOV5xG2Mke4-jPpXRi07KbNEHSaxLUfynmTCSxcuDYrQ4t4xj-HjNViRdMO-YFOVY7HoXjisbfrz52PriBSW7gu9wh5tR7qDGsevY5sc1uuJQmevq2xnbP3_--sOtz7xPWvn8ok8SbmSXU9EB0fjcTWfTy09ZBnrb13a8CVp4fGYOjQGhXSOGcQxcBd8vUI49d9POqO5p1wyQ_JBzyZdRk6_mkeEts0zg2ELa7YSZaMG05dCn5b3L6Qmh3JSctuR8tzmWlu37_baEFshTsr-3aEzUfUkTPg_gB9GFvXg21EBpj1p7tH8uDSUtUb6IffvlMPuGAMkvNgkkSvJrSxoVGhkEGyu8gjSobHx-7-FSju231adlrr7Mpi4oVfPbWdvj3lw81_gOi8hErPhnEpQC-qnPyDXM5vu1Zr_nzzqhqfJD_ZITPoCTxKxY3uKGZd-JsaHuYP0MOh7yi5soUuaqBNOb9Zo5eaj_-VfmZ27KVQl_Kkf-SMKkXIiq-8Xkpl8i9KmYf6u8th6z_VjLX1loKk6CLxn6UlUvxM0SvTUwR0eYGPHjzKl1uGASadmFk1Ma7bRPatL8Va-ZLr-ea2BWbeVraPLdjYAg0_QEndIX4XcL4ocdGw1kVtXeg5GLmsx6xreWHjG5Wbd3rfIjICT5q31po1vUqICLgv3BrF8ePQJFamgXwQIFTmU6xCPwINBM3Jm9PaMUjyY2wLV-RPODBBa9c-HyKiDFue36gDSqKmVDAqXJZeQPlBpocVTI08VfDqOYGMD3-mqFTpnVF-0zQgepC1w0sNThiV9FdcCQGVBVhBAWWNzHz31g0dm9bPbhJP7iPAJ1w8Ayll6IxgiuDnVhKx3ZkonKPVFJu3pI_w_jv_8DMtZs2-4LAAA=',
                id: '12b1b8d1-1703-4c8f-a2dc-118c12010652',
                //for Power BI Embedded
                tokenType: models.TokenType.Embed,
                //tokenType: tokenType == '0' ? models.TokenType.Aad : models.TokenType.Embed,
                embedUrl: 'https://app.powerbi.com/reportEmbed?reportId=3a73c36a-603a-404c-bb62-07068010b2b4&groupId=cb6d2214-38ec-405c-a7fc-92d3c32602f9',
                permissions: permissions,
                settings: {
                    filterPaneEnabled: true,
                    navContentPaneEnabled: true
                }

            };

            var $reportContainer = $('#reportContainer');
            var report = powerbi.embed($reportContainer.get(0), embedConfiguration);

        }

        function showVisuals() {
            var $reportContainer = $('#reportContainer')[0];
            var report = powerbi.get($reportContainer);

            report.getPages()
                .then(function (pages) {
                    // Retrieve active page.
                    var activePage = pages.find(function (page) {
                        console.log("Active page is : " + page.name + " - " + page.displayName);
                        return page.isActive;
                    });

                    activePage.getVisuals()
                        .then(function (visuals) {
                            console.log(
                                visuals.map(function (visual) {
                                    return {
                                        name: visual.name,
                                        type: visual.type,
                                        title: visual.title,
                                        layout: visual.layout
                                    };
                                }));
                        })
                        .catch(function (errors) {
                            console.log(errors);
                        });
                })
                .catch(function (errors) {
                    console.log(errors);
                });
        }       

        function showPage(pageName = "ReportSectione9dfbb33d4de29236d74") {
            var $reportContainer = $('#reportContainer')[0];
            var report = powerbi.get($reportContainer);
            const page = report.page('ReportSectione9dfbb33d4de29236d74');
            page.setActive();
            // report.setPage(pageName)
            //     .then(function () {
            //         console.log("Page was set to: " + pageName);
            //     })
            //     .catch(function (errors) {
            //         console.log(errors);
            //     });
        }
    </script>
</head>

<body>
    <div id="reportContainer"></div>
    <button id="showVisuals" onclick="showVisuals();">Show Visuals</button>
    <button id="showPage" onclick="showPage();">Show Page</button>
</body>

</html>