<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/jquery/dist/jquery.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/powerbi-client/dist/powerbi.js"></script>
    <script src="https://microsoft.github.io/PowerBI-JavaScript/demo/node_modules/powerbi-client/dist/powerbi.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.3/es6-shim.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>Power Bi - Report</title>
    <style>
        div {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            margin-top: 100px
        }
    </style>
    <script type="text/javascript">
        window.onload = function () {
        
            var models = window['powerbi-client'].models;

            var permissions = models.Permissions.All;

            var embedConfiguration = {
                type: 'report',
                //pageName: 'ReportSection',
                // visualName: '5a874c7e3621b4bb98b9',
                accessToken: 'H4sIAAAAAAAEACWWtw70iA2E3-VvZUA5rIErlKVVzqFTzjnL8Lt7fdewmobfkEP-54-ZPP2U5H_-_QdxSK1MT-qjy-Dl2GXMvOm76U4IhkSTVfPUpwBlO0Btdqi2GvFtYvmyHBYyadkznhjeh6IAfkklpm3MD8agV_s2qRNIGzUdwGoPGl9_mUEdZ-kWImzv4oZWyabGixpg9Bnc-zQAzPaKNIcobZdJT_WUGQ4RgcBNS8RBAq70A5APnksJkbWLVaJO3OFY5ajO8km_7-E3EWaBOviFuju0DG8Wg7s4Lw9K6BA1SeZlRd_YMItjUiliAhbO6zj9rrTi2jUNZUl6-ZANMCi9iNPHNv3X9bw2zcdWPMLHNTDCmJvx8kZ4XGxXovGzu7XcYSnnQMvDvsRUFjTcheFJuHOGkmharv01lSOxHEEyynmq4w5yoXB_8HWbGHTuynNQ2AshJqu7Xs1KURiSR9dtAdRO16wE7BYBQ-_7uywgask-pYF9otUUFQ1WfauleDwlLJ6_4sDJROwOfMDlSzvH3VDwDsey6gmT4a3OeJYA6BH4kZPX9Gh6hWFYrEl9zllHT49e-fXqEvDmjgVTu7LBAJDHZsV9_H1td0Bk2c6NFAihV04AD_2WqqQmtua_xoMjnaJmxUKCpw_WBWLw1kXvLfwagTQR_EwVPIuwIoH3nKiC6nUdrsRRaUCwnInPoxJXanmEc4PwAMrPm66LIgMsedoHk1ouvep5Zwy8aX2o15R4QIXH_Di7SXIEsAcKnavODcNkASzJrRYZZewUs1QFDVyoG74GQPzqUtKVrKGdPYv6IPWIYvH4yqNEguRrpP5rQ2AO9JXfxKQI9qMICg0I-UtkAkDvDPvZ7LkJmxIiJJ4q8Y-6V_ZNkUm_hTsWil-DkhydrZSoiemwghFvuTeQzjWaxDRVrV0o-fglFwBdh8ui6UU25dxkQ8yGBQ0ut5RMWJhOkI0hz8fAJJlBYYtYD-Rcv7ucSdXKV5wVJ_35zQzOiLmaBSwsOTKlVKhRH3x3qRwzJg50U6BxAAMWCVAK3lMKqyJiTGnQqsYrIcaNQEuQIKn1JPStFhRCfTh8-nRRbYYJo6jV7NP0xRjscBLT3RIniFN2X9Z0XnGCXhKcGpYFqC4oXIhz94EZSl1uTgfBy2QOx7rdXbxSdSrJwBXYbaNqcT8ikWhZmJxtWB-BU2qvQYTz51MGQOTiO2Lws1FiCcXIU0dTkRtOVScVyE_5yUhiWescc7K5cyqr5IlHgJR5P_UqYFJZR_H9mY9Zzr-tDF3PgG_MtkmoWMSXAszL0rr7BxpHzSEyuRqeVs4SvbCzhrrTVYEqmyfyvTiT650Fn96V1UzmfYUg2omOLRZ8i4EsJWc7Df8RpqhAkeDKZiOT_c0rNOYgr-YSeoZ8SBp8nts_JmieYu9MP4eiNWxUPqioqkvRmNEDjacKSRyNdXo95U4y8kC0jSuxncNuAmkoN8WUFbqt8-IYkiP_ndBLSHF9T3XTnfMUZx70QUlVRMkRY0ndQQ01Ki_SKYMhFNrPucHFYErbjSjmrs8n7zibHbixSWcazQUKmGSrNDqTTsMpgzR67OsEKY55XT8LN23sQ97FdEK9IAK8L3k9vEeTccTVt2wK7Il7KbIGSGrBPhd0k_wcDGXBHHTd5hcn01vZFImuHPKDouKp8TkF5g2pBDaUtlX5pVOHiPCfiSBFLO1Cuwi4eNaO5LmBanbxXsc-6_PHadWbyJ-koJSzFjaWFgto4z6QDlKW1iCDSi9mZgkdAxFlDVG2BblDLagYWo2Mg1iSBVtGDzMbvHC1-bzglILtnsuFv8f-5mrnbmScre-VJorlbGjajTw4s9G4Kq1uA34IG1QbTdg44iZkYuBQQeADuc3unuQq3MaBk5Y-HJLzp32xTBWfz5N3-nI-8huDQ6wu654An_uLD-zW41pUJwBxHfl42tEFPua1F3Wky1WQpm5mAS_-gq0YUeMtcRuDN00qNL-9MQPxDBdh-bAQkkRwJ7WEo-CUn-s_S_CFcxbNH0qnrVaSFNGeLrSMdT_kgL0tBwnVWk6-BT00wkPdE7A3M6K0JQcQDUy8Yj1nGVP7EjZiP6a9HZAgl9IvjnPl2_yitHU8bD7Ns71FzWWv5MJzHWJI4TVy7Vsuoga7t36K6u4FhQKhxsnOGwJniTWF3xZeThIxF_aAF4h3sKmmMcoF1DCi7swSVam5jkZlVmG1ueFTKDsbffoQis1B6w2LBk9bjE8BngWemUAXvT_TPX5XOfiqXuNYq8OiEcE5GWhRBtqmAp9n1IuIwQbti1H2hQrnPyZT6FDXMj7Ti3mIpg8MJvIx1kg6Zf31159__WHXZ94npXh-b04AkeQyLblMZ6QRixfRHSqEpOJ1XKdxLCMFfRKvr30iXepgOd6Q5Ck3eUdt9ZhPd3QVURCy5n38OXN5AHFe2hhcVXjVINhLB6TWYdxSrZ9fO8GZeNQ0IdUwaQBBUi0H2GX5Lk55_tS6rx_s7U449xe-JToztStJSDuqOXsjLP5oudvuRwLFR5L22lIzzM4eXbYUkKFi043wWP_pPmL52oVvpMcB4DwEYLr2yKPy5fQN92n4B6O2v-GUb2fkZljidPiNVbegW_zpkWjF1BKncdLEmDMC8Kre3ygVUFvSjIwnS9uG9GsQTS1ZdgUuUEbVP-3QE7QxP2OXVC60OVbKxNEnuP7B_Mx1scr-j3ITxMRCD1gtFdSwkiwmec1D_61ymmpM9mMtfrJa3Mjl1VqLVfHhKPGbcWLmfkIJd8PUvXguSxltefo6nXPh9yWdJUKyVorVTecCNQ63rZghjsm8-owGkKVD-luly_LBtEsPdJ1YnhU4pdjHuiRVibcwJW0a5eAp0L6rBiWDykp8zTgLAbBdCaQBkRAePlWdevVRzU2CIjbYyY49bMUsCuUHkidGgPbvb1-We0Lu3Xxm5aDWTE7Q7oxwaGANpJLwS8dw7cFx-JH5yEwkDAL78qh_QWiwvzMRH1GUJ5gqoe7ST0IIRGPHJT0OwWGM0OKXU0OUYMJDEynj8MwHv-ZXO-yNFc4oTLNNHDgo50vQfKih_Z3HWQmRzEP2_Pi6bPN_M_77P9xE5VraCwAA',
                id: 'f353054b-1e85-4043-9e40-5eb91dc06d9b',
                //for Power BI Embedded
                tokenType: models.TokenType.Embed,
                //tokenType: tokenType == '0' ? models.TokenType.Aad : models.TokenType.Embed,
                embedUrl: 'https://app.powerbi.com/reportEmbed?reportId=f353054b-1e85-4043-9e40-5eb91dc06d9b&groupId=cb6d2214-38ec-405c-a7fc-92d3c32602f9',
                permissions: permissions,
                settings: {
                    filterPaneEnabled: true,
                    navContentPaneEnabled: true
                }

            };

            var $reportContainer = $('#reportContainer');
            var report = powerbi.embed($reportContainer.get(0), embedConfiguration);

        }

        function showVisuals() {
            var $reportContainer = $('#reportContainer')[0];
            var report = powerbi.get($reportContainer);

            report.getPages()
                .then(function (pages) {
                    // Retrieve active page.
                    var activePage = pages.find(function (page) {
                        console.log("Active page is : " + page.name + " - " + page.displayName);
                        return page.isActive;
                    });

                    activePage.getVisuals()
                        .then(function (visuals) {
                            console.log(
                                visuals.map(function (visual) {
                                    return {
                                        name: visual.name,
                                        type: visual.type,
                                        title: visual.title,
                                        layout: visual.layout
                                    };
                                }));
                        })
                        .catch(function (errors) {
                            console.log(errors);
                        });
                })
                .catch(function (errors) {
                    console.log(errors);
                });
        }       

        function showPage(pageName = "ReportSectione9dfbb33d4de29236d74") {
            var $reportContainer = $('#reportContainer')[0];
            var report = powerbi.get($reportContainer);
            const page = report.page('ReportSectione9dfbb33d4de29236d74');
            page.setActive();
            // report.setPage(pageName)
            //     .then(function () {
            //         console.log("Page was set to: " + pageName);
            //     })
            //     .catch(function (errors) {
            //         console.log(errors);
            //     });
        }
    </script>
</head>

<body>
    <div id="reportContainer"></div>
    <button id="showVisuals" onclick="showVisuals();">Show Visuals</button>
    <button id="showPage" onclick="showPage();">Show Page</button>
</body>

</html>